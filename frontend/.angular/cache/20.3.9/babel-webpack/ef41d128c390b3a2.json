{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nimport * as i2 from \"@angular/router\";\nexport let AuthGuard = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class AuthGuard {\n    constructor(authService, router) {\n      this.authService = authService;\n      this.router = router;\n    }\n    canActivate(route, state) {\n      console.log('ðŸ›¡ï¸ [AuthGuard] Intentando entrar a:', state.url);\n      const isLogged = this.authService.isLoggedIn();\n      console.log('ðŸ›¡ï¸ [AuthGuard] Â¿EstÃ¡ logueado?', isLogged);\n      // 1) Â¿EstÃ¡ logueado?\n      if (!isLogged) {\n        console.log('ðŸ›‘ [AuthGuard] No hay token, redirigiendo a /login con returnUrl =', state.url);\n        this.router.navigate(['/login'], {\n          queryParams: {\n            returnUrl: state.url\n          }\n        });\n        return false;\n      }\n      // 2) Â¿Alguna ruta en la jerarquÃ­a requiere admin?\n      const pathRequiresAdmin = route.pathFromRoot?.some(r => r.data?.['requiresAdmin'] === true) || false;\n      console.log('ðŸ›¡ï¸ [AuthGuard] Â¿La ruta requiere admin?', pathRequiresAdmin);\n      if (!pathRequiresAdmin) {\n        // Ruta normal: solo necesita estar logueado\n        console.log('âœ… [AuthGuard] Ruta normal, usuario logueado. Permitir acceso.');\n        return true;\n      }\n      // 3) Si requiere admin â†’ preguntamos al backend\n      console.log('ðŸ§‘â€âš–ï¸ [AuthGuard] Ruta con requiresAdmin = true, verificando con el backend...');\n      return this.authService.isAdminFromApi().then(isAdmin => {\n        console.log('ðŸ§‘â€âš–ï¸ [AuthGuard] Â¿isAdminFromApi() respondiÃ³ admin?', isAdmin);\n        if (!isAdmin) {\n          console.log('â›” [AuthGuard] Usuario NO es admin. Redirigiendo a /inicio');\n          this.router.navigate(['/inicio']);\n          return false;\n        }\n        console.log('âœ… [AuthGuard] Usuario es admin. Permitir acceso.');\n        return true;\n      }).catch(err => {\n        console.error('âŒ [AuthGuard] Error al verificar admin en isAdminFromApi():', err);\n        console.log('â›” [AuthGuard] Por seguridad, redirigiendo a /inicio');\n        this.router.navigate(['/inicio']);\n        return false;\n      });\n    }\n    // Reusar la misma lÃ³gica para rutas hijas\n    canActivateChild(route, state) {\n      console.log('ðŸ›¡ï¸ [AuthGuard] canActivateChild para ruta:', state.url);\n      return this.canActivate(route, state);\n    }\n    static #_ = _staticBlock = () => (this.Éµfac = function AuthGuard_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AuthGuard)(i0.ÉµÉµinject(i1.AuthService), i0.ÉµÉµinject(i2.Router));\n    }, this.Éµprov = /*@__PURE__*/i0.ÉµÉµdefineInjectable({\n      token: AuthGuard,\n      factory: AuthGuard.Éµfac,\n      providedIn: 'root'\n    }));\n  }\n  _staticBlock();\n  return AuthGuard;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}