{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/maty_/Desktop/Tech-Reboot2.0/TechReboot/TechReboot/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpHeaders } from '@angular/common/http';\nimport { lastValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let AuthService = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class AuthService {\n    constructor(http) {\n      this.http = http;\n      // ðŸ‘€ AsegÃºrate que tu backend realmente corre en http://localhost:4000\n      // y que montaste las rutas como: app.use('/api/auth', authRoutes)\n      this.apiUrl = 'http://localhost:4000/api/auth';\n    }\n    normalizarCorreo(value) {\n      return value?.trim().toLowerCase() ?? '';\n    }\n    // ðŸŸ¢ Registrar usuario\n    register(user) {\n      const payload = {\n        nombre: user.nombre,\n        correo: this.normalizarCorreo(user.correo ?? user.email),\n        password: user.password\n      };\n      return lastValueFrom(this.http.post(`${this.apiUrl}/register`, payload, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }));\n    }\n    // ðŸŸ¢ Iniciar sesiÃ³n\n    login(credentials) {\n      const payload = {\n        correo: this.normalizarCorreo(credentials.correo ?? credentials.email),\n        password: credentials.password\n      };\n      return lastValueFrom(this.http.post(`${this.apiUrl}/login`, payload, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }));\n    }\n    // ðŸ” Verificar sesiÃ³n (solo front)\n    isLoggedIn() {\n      return !!localStorage.getItem('token');\n    }\n    // ðŸ‘¤ Obtener usuario actual desde el backend (/auth/me)\n    getCurrentUser() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const token = localStorage.getItem('token');\n        if (!token) return null;\n        const headers = new HttpHeaders({\n          Authorization: `Bearer ${token}`\n        });\n        try {\n          const res = yield lastValueFrom(_this.http.get(`${_this.apiUrl}/me`, {\n            headers\n          }));\n          return res; // { id?, nombre?, correo?, rol?, esAdmin? }\n        } catch (err) {\n          console.error('Error al obtener /auth/me:', err);\n          return null;\n        }\n      })();\n    }\n    // ðŸ‘‘ Preguntar al backend si el usuario es admin\n    isAdminFromApi() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const user = yield _this2.getCurrentUser();\n        if (!user) return false;\n        return user.rol === 'admin' || user.esAdmin === true;\n      })();\n    }\n    // ðŸšª Cerrar sesiÃ³n\n    logout() {\n      localStorage.removeItem('token');\n      localStorage.removeItem('usuario');\n      // aquÃ­ podrÃ­as borrar mÃ¡s cosas si las usas\n    }\n    static #_ = _staticBlock = () => (this.Éµfac = function AuthService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AuthService)(i0.ÉµÉµinject(i1.HttpClient));\n    }, this.Éµprov = /*@__PURE__*/i0.ÉµÉµdefineInjectable({\n      token: AuthService,\n      factory: AuthService.Éµfac,\n      providedIn: 'root'\n    }));\n  }\n  _staticBlock();\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}