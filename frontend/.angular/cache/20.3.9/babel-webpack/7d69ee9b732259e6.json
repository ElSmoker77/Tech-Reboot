{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/thjean/Downloads/TechReboot/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { ComponenteServicio } from 'src/app/services/componentes.service';\nlet ComponentesComponent = class ComponentesComponent {\n  constructor(servicio, router) {\n    this.servicio = servicio;\n    this.router = router;\n    this.componente = {\n      nombre: '',\n      categoria: '',\n      estado: '',\n      ubicacion: '',\n      fechaIngreso: '',\n      responsable: '',\n      descripcion: ''\n    };\n    this.guardado = false;\n    this.isEditing = false;\n    this.currentId = null;\n    this.listaComponentes = [];\n    this.categorias = ['placa', 'batería', 'pantalla', 'cable', 'periférico', 'electrodoméstico', 'otro'];\n    this.estados = ['reacondicionable', 'reutilizable', 'desecho'];\n  }\n  ngOnInit() {\n    this.cargarComponentes();\n  }\n  guardar() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const payload = {\n          ..._this.componente,\n          fechaIngreso: _this.parseDate(_this.componente.fechaIngreso)\n        };\n        if (_this.isEditing && _this.currentId) {\n          yield _this.servicio.updateComponente(_this.currentId, payload).toPromise();\n        } else {\n          yield _this.servicio.createComponente(payload).toPromise();\n        }\n        _this.guardado = true;\n        setTimeout(() => _this.guardado = false, 1800);\n        _this.resetForm();\n        _this.cargarComponentes();\n      } catch (err) {\n        console.error('Error al guardar componente:', err);\n        alert('No se pudo guardar el componente. Revisa la consola para más detalles.');\n      }\n    })();\n  }\n  cargarComponentes() {\n    this.servicio.getComponentes().subscribe({\n      next: data => this.listaComponentes = data,\n      error: err => {\n        console.error('Error al cargar componentes:', err);\n        alert('No se pudieron cargar los componentes.');\n      }\n    });\n  }\n  editarComponente(c) {\n    this.isEditing = true;\n    this.currentId = c._id ?? null;\n    const fecha = c.fechaIngreso ? this.formatDateForInput(c.fechaIngreso) : '';\n    this.componente = {\n      nombre: c.nombre ?? '',\n      categoria: c.categoria ?? '',\n      estado: c.estado ?? '',\n      ubicacion: c.ubicacion ?? '',\n      fechaIngreso: fecha,\n      responsable: c.responsable ?? '',\n      descripcion: c.descripcion ?? ''\n    };\n    window.scrollTo({\n      top: 0,\n      behavior: 'smooth'\n    });\n  }\n  eliminarComponente(id) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const ok = confirm('¿Eliminar este componente? Esta acción no se puede deshacer.');\n      if (!ok) return;\n      try {\n        yield _this2.servicio.deleteComponente(id).toPromise();\n        _this2.cargarComponentes();\n      } catch (err) {\n        console.error('Error al eliminar componente:', err);\n        alert('No se pudo eliminar el componente.');\n      }\n    })();\n  }\n  volver() {\n    this.router.navigate(['/menu']);\n  }\n  resetForm() {\n    this.componente = {\n      nombre: '',\n      categoria: '',\n      estado: '',\n      ubicacion: '',\n      fechaIngreso: '',\n      responsable: '',\n      descripcion: ''\n    };\n    this.isEditing = false;\n    this.currentId = null;\n  }\n  parseDate(value) {\n    if (!value) return new Date();\n    if (value instanceof Date) return value;\n    const [y, m, d] = value.split('-').map(Number);\n    return new Date(Date.UTC(y, m - 1, d, 0, 0, 0));\n  }\n  formatDateForInput(date) {\n    const d = new Date(date);\n    const yyyy = d.getUTCFullYear();\n    const mm = String(d.getUTCMonth() + 1).padStart(2, '0');\n    const dd = String(d.getUTCDate()).padStart(2, '0');\n    return `${yyyy}-${mm}-${dd}`;\n  }\n  logout() {\n    this.auth.logout();\n    this.router.navigate(['/login']);\n  }\n};\nComponentesComponent = __decorate([Component({\n  selector: 'app-componentes',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  providers: [ComponenteServicio],\n  templateUrl: './componentes.html',\n  styleUrls: ['./componentes.css']\n})], ComponentesComponent);\nexport { ComponentesComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}