<section class="componentes-section">
  <!-- CARD DEL FORMULARIO ADMIN -->
  <div class="componentes-form">
    <!-- HEADER del form, similar a otros admin -->
    <div class="componentes-form__header">
      <div class="header-icon">
        <i class="bi bi-cpu-fill"></i>
      </div>
      <div>
        <h2>Registro de componentes (Admin)</h2>
        <p class="componentes-form__subtitle">
          Registra y clasifica componentes recuperados para llevar control de inventario e impacto.
        </p>
      </div>
    </div>

    <form (ngSubmit)="guardar(form)" #form="ngForm" novalidate>
      <div class="row g-3">
        <!-- Nombre -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-puzzle me-2 text-success"></i> Nombre
          </label>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="componente.nombre"
            name="nombre"
            placeholder="Ej: Fuente ATX 500W, Placa B450..."
            required
            [ngClass]="{ 'is-invalid': form.submitted && !componente.nombre }"
          />
          <div
            *ngIf="form.submitted && !componente.nombre"
            class="invalid-feedback"
          >
            El nombre es obligatorio.
          </div>
        </div>

        <!-- Categoría -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-tags-fill me-2 text-success"></i> Categoría
          </label>
          <select
            class="form-select"
            [(ngModel)]="componente.categoria"
            name="categoria"
            required
            [ngClass]="{ 'is-invalid': form.submitted && !componente.categoria }"
          >
            <option value="">Seleccione...</option>
            <option *ngFor="let cat of categorias" [value]="cat">
              {{ cat }}
            </option>
          </select>
          <div
            *ngIf="form.submitted && !componente.categoria"
            class="invalid-feedback"
          >
            Selecciona una categoría.
          </div>
        </div>

        <!-- Estado -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-recycle me-2 text-success"></i> Estado
          </label>
          <select
            class="form-select"
            [(ngModel)]="componente.estado"
            name="estado"
            required
            [ngClass]="{ 'is-invalid': form.submitted && !componente.estado }"
          >
            <option value="">Seleccione...</option>
            <option *ngFor="let est of estados" [value]="est">
              {{ est }}
            </option>
          </select>
          <div
            *ngIf="form.submitted && !componente.estado"
            class="invalid-feedback"
          >
            Selecciona un estado.
          </div>
        </div>

        <!-- Peso aproximado (kg) -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-speedometer2 me-2 text-success"></i> Peso aprox. (kg)
          </label>
          <input
            type="number"
            class="form-control"
            [(ngModel)]="componente.pesoKg"
            name="pesoKg"
            min="0"
            step="0.1"
            placeholder="Ej: 1.3"
          />
          <div class="form-text">
            Puedes dejarlo vacío si no sabes el peso exacto.
          </div>
        </div>

        <!-- Ubicación -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-geo-alt-fill me-2 text-success"></i> Ubicación
          </label>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="componente.ubicacion"
            name="ubicacion"
            placeholder="Ej: Almacén central / Punto Sur"
          />
        </div>

        <!-- Fecha de ingreso -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-calendar-date-fill me-2 text-success"></i> Fecha de ingreso
          </label>
          <input
            type="date"
            class="form-control"
            [(ngModel)]="componente.fechaIngreso"
            name="fechaIngreso"
            required
            [ngClass]="{
              'is-invalid': form.submitted && !componente.fechaIngreso
            }"
          />
          <div
            *ngIf="form.submitted && !componente.fechaIngreso"
            class="invalid-feedback"
          >
            La fecha es obligatoria.
          </div>
        </div>

        <!-- Responsable (nombre) -->
        <div class="col-md-6">
          <label class="form-label">
            <i class="bi bi-person-fill me-2 text-success"></i> Responsable
          </label>
          <input
            type="text"
            class="form-control"
            [(ngModel)]="componente.responsable"
            name="responsable"
            placeholder="Ej: Erwin Ormeño"
          />
        </div>

        <!-- Descripción FULL WIDTH (2 columnas) -->
        <div class="form-group-descripcion campo-descripcion">
          <label class="form-label">
            <i class="bi bi-info-circle-fill me-2 text-success"></i>
            Descripción
          </label>
          <textarea
            class="form-control"
            [(ngModel)]="componente.descripcion"
            name="descripcion"
            rows="3"
            placeholder="Notas técnicas, modelo, pruebas pendientes..."
          ></textarea>
          <div class="form-text">
            Agrega detalles útiles: modelo exacto, estado físico,
            fallas detectadas, pruebas realizadas, etc.
          </div>
        </div>
      </div>

      <!-- BOTÓN PRINCIPAL -->
      <div class="d-grid mt-4 gap-2">
        <button type="submit" class="btn btn-success">
          <i class="bi bi-save2-fill me-2"></i>
          {{ isEditing ? 'Actualizar componente' : 'Registrar componente' }}
        </button>
      </div>
    </form>

    <!-- ✅ Toast local flotante (usa la variable guardado) -->
    <div *ngIf="guardado" class="componentes-toast componentes-toast--success">
      <i class="bi bi-check-circle-fill me-2"></i>
      {{ isEditing ? 'Componente actualizado correctamente.' : 'Componente registrado correctamente.' }}
    </div>
  </div>
</section>
